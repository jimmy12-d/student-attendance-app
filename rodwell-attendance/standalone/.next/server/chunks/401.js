"use strict";exports.id=401,exports.ids=[401],exports.modules={73537:(t,e,s)=>{s.d(e,{A:()=>r});var a=s(45512);s(58009);let r=({title:t,children:e})=>(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3 pl-4",children:[(0,a.jsx)("h1",{className:"text-2xl",children:t}),e]})},72420:(t,e,s)=>{s.d(e,{A:()=>c});var a=s(45512),r=s(12113),l=s(33883),n=s(95900),i=s(24719),o=s(73537),d=s(56492);let c=({title:t,buttonColor:e,buttonLabel:s,isActive:c,children:u,modalClassName:g="w-11/12 md:w-3/5 lg:w-2/5 xl:w-4/12",onConfirm:m,onCancel:x})=>{if(!c)return null;let p=(0,a.jsxs)(n.A,{type:"justify-end",children:[(0,a.jsx)(l.A,{label:s,color:e,onClick:m,isGrouped:!0}),!!x&&(0,a.jsx)(l.A,{label:"Cancel",color:e,outline:!0,onClick:x,isGrouped:!0})]});return(0,a.jsx)(d.A,{onClick:x,className:x?"cursor-pointer":"",children:(0,a.jsxs)(i.A,{className:`transition-transform shadow-lg max-h-modal ${g} z-50`,isModal:!0,footer:p,children:[(0,a.jsx)(o.A,{title:t,children:!!x&&(0,a.jsx)(l.A,{icon:r.hyP,color:"whiteDark",onClick:x,small:!0,roundedFull:!0})}),(0,a.jsx)("div",{className:"space-y-3 pl-4",children:u})]})})}},66055:(t,e,s)=>{s.d(e,{A:()=>d});var a=s(45512),r=s(12113),l=s(58009),n=s(37954),i=s(33883),o=s(83877);let d=({outline:t=!1,children:e,...s})=>{let d=t?n.Fw[s.color]:n.cu[s.color],[c,u]=(0,l.useState)(!1);return c?null:(0,a.jsx)("div",{className:`px-3 py-6 md:py-3 mb-6 last:mb-0 border rounded-lg transition-colors duration-150 ${d}`,children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-center mb-6 md:mb-0",children:[s.icon&&(0,a.jsx)(o.A,{path:s.icon,w:"w-10 md:w-5",h:"h-10 md:h-5",size:"24",className:"md:mr-2"}),(0,a.jsx)("span",{className:"text-center md:text-left md:py-2",children:e})]}),s.button,!s.button&&(0,a.jsx)(i.A,{icon:r.hyP,color:"white",onClick:t=>{t.preventDefault(),u(!0)},small:!0,roundedFull:!0})]})})}},80874:(t,e,s)=>{s.d(e,{A:()=>i});var a=s(45512);s(58009);var r=s(83877),l=s(37954);function n({icon:t,color:e,w:s="w-12",h:n="h-12",bg:i=!1,className:o=""}){let d=i?l.cu[e]:`${l.Wj[e]} bg-gray-50 dark:bg-slate-800`;return(0,a.jsx)(r.A,{path:t,w:s,h:n,size:"24",className:`rounded-full ${d} ${o}`})}function i({icon:t,title:e,main:s=!1,children:l}){return(0,a.jsxs)("section",{className:`${s?"":"pt-6"} mb-6 flex items-center justify-between`,children:[(0,a.jsxs)("div",{className:"flex items-center justify-start",children:[t&&s&&(0,a.jsx)(n,{icon:t,color:"light",className:"mr-3",bg:!0}),t&&!s&&(0,a.jsx)(r.A,{path:t,className:"mr-2",size:"20"}),(0,a.jsx)("h1",{className:`leading-tight ${s?"text-3xl":"text-2xl"}`,children:e})]}),l]})}},48518:(t,e,s)=>{s.d(e,{A:()=>g});var a=s(45512),r=s(58009),l=s(17656),n=s(72420),i=s(72462),o=s(92021),d=s(33883),c=s(12113);let u=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],g=({student:t,attendanceRecords:e,allClassConfigs:s,approvedPermissions:g,isActive:m,onClose:x,initialMonthValue:p})=>{let[h,f]=(0,r.useState)([]),[b,y]=(0,r.useState)(!0),[w,D]=(0,r.useState)(p||(0,o.AZ)()),j=e=>{let[s,a]=w.split("-"),r=parseInt(s),n=parseInt(a)-1;"prev"===e?--n<0&&(n=11,r--):++n>11&&(n=0,r++);let i=new Date(r,n,1),o=new Date;if(!(i>new Date(o.getFullYear(),o.getMonth(),1))){if(t.createdAt){let e=t.createdAt instanceof l.Dc?t.createdAt.toDate():t.createdAt;if(i<new Date(e.getFullYear(),e.getMonth(),1))return}D(`${r}-${String(n+1).padStart(2,"0")}`)}};(0,r.useEffect)(()=>{if(!m||!t||!s||!w){f([]),m&&y(!1);return}y(!0);let[a,r]=w.split("-"),l=parseInt(a),n=parseInt(r)-1,o=new Date;o.setHours(0,0,0,0);let d=new Map;e.filter(t=>t.date?.startsWith(w)).forEach(t=>d.set(t.date,t));let c=new Date(l,n,1).getDay(),u=new Date(l,n+1,0).getDate(),x=[],p=[],h=1;for(let t=0;t<c;t++)p.push({dayOfMonth:null});for(;h<=u;){7===p.length&&(x.push(p),p=[]);let e=new Date(l,n,h);e.setHours(0,0,0,0);let a=`${l}-${String(n+1).padStart(2,"0")}-${String(h).padStart(2,"0")}`,r=d.get(a),c=(0,i.tE)(t,a,r,s,g),u={dayOfMonth:h,fullDateStr:a,isToday:e.getTime()===o.getTime(),isPast:e<o,status:c.status,time:c.time,isSchoolDayCell:!["Not Applicable (Holiday/Weekend)","Not Yet Enrolled","No School"].includes(c.status||"")};p.push(u),h++}for(;p.length>0&&p.length<7;)p.push({dayOfMonth:null});p.length>0&&x.push(p),f(x),y(!1)},[m,t,e,s,g,w]);let A=t=>{switch(t){case"Present":return"bg-green-200 text-green-800";case"Late":return"bg-yellow-200 text-yellow-800";case"Absent":return"bg-red-200 text-red-800";case"Permission":return"bg-purple-200 text-purple-800";case"Pending":return"bg-blue-100 text-blue-700";case"Absent (Config Missing)":return"bg-orange-100 text-orange-700";case"Not Applicable (Holiday/Weekend)":return"text-gray-400";case"Not Yet Enrolled":return"text-gray-400 dark:text-slate-500";case"Unknown":return"bg-gray-200 text-gray-700 dark:bg-gray-600 dark:text-gray-200";default:return"text-transparent"}},N=(0,r.useMemo)(()=>{if(w){let[t,e]=w.split("-");if(t&&e)return new Date(parseInt(t),parseInt(e)-1,1).toLocaleString("default",{month:"long",year:"numeric"})}return"Details"},[w]),{isPrevDisabled:S,isNextDisabled:$}=(0,r.useMemo)(()=>{let e=new Date,s=e.getFullYear(),a=e.getMonth(),[r,n]=w.split("-").map(Number),i=n-1,o=!1;if(t.createdAt){let e=t.createdAt instanceof l.Dc?t.createdAt.toDate():t.createdAt,s=e.getFullYear(),a=e.getMonth();(r<s||r===s&&i<=a)&&(o=!0)}else r<s-2&&(o=!0);return{isPrevDisabled:o,isNextDisabled:r>s||r===s&&i>=a}},[w,t.createdAt]);return(0,a.jsxs)(n.A,{title:`Attendance: ${t.fullName}`,isActive:m,onConfirm:x,buttonLabel:"Close",buttonColor:"info",modalClassName:"w-11/12 md:w-4/5 lg:w-3/5 xl:max-w-4xl",children:[(0,a.jsxs)("div",{className:"mb-4 flex justify-between items-center px-2 sm:px-4 py-2 border-b dark:border-slate-700",children:[(0,a.jsx)(d.A,{icon:c.LyG,onClick:()=>j("prev"),small:!0,outline:!0,color:"lightDark","aria-label":"Previous Month",disabled:S}),(0,a.jsx)("h3",{className:"text-md sm:text-lg font-semibold text-gray-700 dark:text-gray-200",children:N}),(0,a.jsx)(d.A,{icon:c.mI8,onClick:()=>j("next"),small:!0,outline:!0,color:"lightDark","aria-label":"Next Month",disabled:$})]}),b?(0,a.jsx)("p",{className:"p-4 text-center",children:"Loading details..."}):0===h.length?(0,a.jsx)("p",{className:"p-4 text-center",children:"No attendance details to display."}):(0,a.jsx)("div",{className:"text-sm p-1 md:p-2",children:(0,a.jsxs)("table",{className:"w-full table-fixed border-collapse text-center",children:[(0,a.jsx)("thead",{children:(0,a.jsx)("tr",{children:u.map(t=>(0,a.jsx)("th",{className:"py-2 px-1 border dark:border-slate-700 font-semibold text-xs text-center",children:t},t))})}),(0,a.jsx)("tbody",{children:h.map((t,e)=>(0,a.jsx)("tr",{children:t.map((t,e)=>(0,a.jsx)("td",{className:`py-1 px-1 border dark:border-slate-700 h-16 md:h-20 relative align-top text-left transition-colors duration-150 ease-in-out
                      ${t.isToday?"bg-sky-100 dark:bg-sky-700/60":!t.isSchoolDayCell&&t.dayOfMonth?"bg-gray-100 dark:bg-slate-800 opacity-70":t.dayOfMonth&&t.isPast?"bg-white dark:bg-slate-700/50":t.dayOfMonth&&!t.isPast?"bg-slate-50 dark:bg-slate-800/80":"bg-gray-50 dark:bg-slate-900"}`,children:t.dayOfMonth&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:`absolute top-1 left-1 text-s p-0.5 
                            ${t.isToday?"font-bold text-sky-600 dark:text-sky-200":t.isPast||t.status?"text-gray-800 dark:text-gray-100 font-medium":"text-gray-400 dark:text-slate-500"}`,children:t.dayOfMonth}),(0,a.jsxs)("div",{className:"absolute inset-0 top-5 md:top-6 flex flex-col items-center justify-start pt-1 px-0.5 text-center",children:[t.status&&["Present","Late","Absent","Pending","Permission","Absent (Config Missing)","Unknown"].includes(t.status)&&(0,a.jsx)("span",{className:`px-1.5 py-0.5 text-xs sm:text-xs rounded-full leading-tight whitespace-nowrap font-semibold ${A(t.status)}`,children:"Absent (Config Missing)"===t.status?"Absent*":t.status}),("Present"===t.status||"Late"===t.status)&&t.time&&(0,a.jsx)("span",{className:`block text-xxs mt-0.5 pt-1 leading-tight ${t.isToday?"text-sky-700 dark:text-sky-200":"text-gray-500 dark:text-gray-400"}`,children:t.time?`(${t.time})`:""}),("Not Applicable (Holiday/Weekend)"===t.status||"Not Yet Enrolled"===t.status)&&(0,a.jsx)("span",{className:`text-xxs leading-tight opacity-70 ${A(t.status)} ${t.isToday?"font-medium":""}`,children:"Not Applicable (Holiday/Weekend)"===t.status?"Non-School":"Not Enrolled"})]})]})},e))},e))})]})})]})}},72462:(t,e,s)=>{s.d(e,{AK:()=>d,as:()=>n,rM:()=>o,tE:()=>i,zV:()=>c});var a=s(17656),r=s(92021);let l=(t,e)=>{let s=t.getDay(),a=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;return!r.sU.has(a)&&(e&&e.length>0?e.includes(s):0!==s)},n=(t,e)=>{let s,a;let r=new Date;if(t===r.getFullYear()&&e===r.getMonth())s=r.getDate(),a=`${t}-${String(e+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`;else{let r=new Date(t,e+1,0).getDate();s=r,a=`${t}-${String(e+1).padStart(2,"0")}-${String(r).padStart(2,"0")}`}let l=`${t}-${String(e+1).padStart(2,"0")}-01`;return{year:t,month:e,monthStartDateString:l,monthEndDateStringUsedForQuery:a,daysInMonthToConsider:s}},i=(t,e,s,n,i)=>{let o=new Date(e);o.setHours(0,0,0,0);let d=new Date;d.setHours(0,0,0,0);let c=t.createdAt instanceof a.Dc?t.createdAt.toDate():t.createdAt instanceof Date?t.createdAt:null;c&&c.setHours(0,0,0,0);let u=t.class,g=u&&n?n[u]:void 0,m=g?.studyDays;if(c&&o<=c)return{status:"Not Yet Enrolled"};if(!l(o,m))return{status:"No School"};if(s){let t;let e="present"===s.status?"Present":"late"===s.status?"Late":"Unknown";return s.timestamp&&(t=(s.timestamp instanceof a.Dc?s.timestamp.toDate():s.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0})),{status:e,time:t}}if(i&&i.some(t=>e>=t.permissionStartDate&&e<=t.permissionEndDate))return{status:"Permission"};if(o.getTime()===d.getTime()){let e=t.shift,s=u&&g?.shifts?g.shifts[e]:void 0;if(!s||!s.startTime)return{status:"Absent (Config Missing)"};{let[e,a]=s.startTime.split(":").map(Number),l=new Date(d);l.setHours(e,a);let n=t.gracePeriodMinutes??r.Lj,i=new Date(l);i.setMinutes(l.getMinutes()+n);let o=new Date(i);return(o.setMinutes(i.getMinutes()+r.l0),new Date>o)?{status:"Absent"}:{status:"Pending"}}}return o<d?{status:"Absent"}:{status:void 0}},o=(t,e,s,a,r=7)=>{let l=0,n=new Date;n.setHours(0,0,0,0);let o=new Map(e.map(t=>[t.date,t]));for(let e=0;e<r;e++){let r=new Date(n);r.setDate(n.getDate()-e);let d=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`,c=o.get(d),u=i(t,d,c,s,a);if("Absent"===u.status)l++;else if("Present"===u.status||"Late"===u.status||"Permission"===u.status)break}return{count:l,details:`${l} consecutive day absences`}},d=(t,e,s,a,r)=>{let[l,o]=s.split("-").map(Number).map((t,e)=>1===e?t-1:t),{daysInMonthToConsider:d}=n(l,o),c=new Date(l,o).toLocaleString("default",{month:"long",year:"numeric"}),u=0,g=new Map(e.map(t=>[t.date,t]));for(let e=1;e<=d;e++){let s=`${l}-${String(o+1).padStart(2,"0")}-${String(e).padStart(2,"0")}`,n=g.get(s);"Absent"===i(t,s,n,a,r).status&&u++}return{count:u,details:`${u} absences in ${c}`}},c=(t,e,s)=>{let a=new Date(parseInt(s.split("-")[0]),parseInt(s.split("-")[1])-1).toLocaleString("default",{month:"long",year:"numeric"}),r=0;return e.forEach(t=>{"late"===t.status&&r++}),{count:r,details:`${r} lates in ${a}`}}},92021:(t,e,s)=>{s.d(e,{AZ:()=>n,Lj:()=>a,l0:()=>r,sU:()=>l});let a=15,r=60,l=new Set(["2025-01-01","2025-01-07","2025-03-08","2025-05-01","2025-05-14","2025-05-15","2025-05-16","2025-06-18","2025-09-24","2025-10-07","2025-10-08","2025-10-09","2025-10-15","2025-10-29","2025-11-09","2025-11-20","2025-11-21","2025-11-22"]),n=(t=new Date)=>{let e=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0");return`${e}-${s}`}}};